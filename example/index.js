/** @jsx h */
import { h, render } from 'preact'

import { GlobalProvider, withGlobal } from 'preact-global'

const emojis = ['😀', '😬', '😂', '😄', '😅', '😇', '☺️', '😋', '😘', '😚', '😜', '🤑', '😎', '🤗', '😳', '🙄', '😤', '😱', '😨', '😰', '😥', '🤒', '😭', '💩', '👹', '💀', '👻', '👽', '🤖', '😺', '😹', '😻', '😼', '😽', '🙀', '😿', '😾', '🙌', '👏', '👋', '👍', '👊', '✊', '✌️', '👌', '✋', '👐', '💪', '☝️', '🙏', '👆', '🖐', '🤘', '🖖', '✍️', '💅', '👄', '👅', '👂', '👁', '👀', '👶', '👦', '👧', '👨', '👩', '👱', '👴', '👵', '👲', '👳', '👷', '💂', '🕵', '🎅', '👼', '👸', '👰', '🚶', '🏃', '💃', '👯', '👫', '👬', '👭', '🙇', '💁', '🙅', '🙆', '🙋', '🙎', '🙍', '💇', '💆', '💑', '👨‍❤️‍👨', '💏', '👩‍❤️‍💋‍👩', '👨‍❤️‍💋‍👨', '👩‍👩‍👦', '👨‍👨‍👦', '👮', '👚', '👕', '👖', '👔', '👗', '👙', '👘', '💄', '💋', '🎩', '👟', '👞', '👢', '👡', '👠', '👣', '⛑', '🎓', '👑', '🎒', '👝', '👛', '👜', '💼', '🌂', '💍', '🕶', '👓', '🐯', '🦁', '🐮', '🐷', '🐽', '🐸', '🐙', '🐵', '🐦', '🐧', '🐔', '🐒', '🙉', '🙈', '🐣', '🐥', '🐺', '🐗', '🐴', '🦄', '🐝', '🐛', '🐢', '🦀', '🦂', '🕷', '🐜', '🐞', '🐌', '🐠', '🐟', '🐡', '🐬', '🐋', '🐊', '🐆', '🐘', '🐫', '🐪', '🐄', '🐂', '🐃', '🐏', '🐑', '🐀', '🐁', '🐓', '🦃', '🐉', '🐾', '🐿', '🐇', '🐈', '🐩', '🐕', '🐲', '🌵', '🎄', '🌲', '🌴', '🌱', '🌿', '🌾', '🍁', '🍂', '🍃', '🎋', '🎍', '🍀', '🌺', '🌻', '🌹', '🌷', '🌼', '🌸', '💐', '🍄', '🎃', '🐚', '🌎', '🌍', '🌏', '🌕', '🌖', '🌗', '🌘', '🌑', '🌒', '🌓', '🌔', '🌚', '🌝', '🌛', '🌜', '🌞', '⭐️', '🌟', '💫', '✨', '☄️', '🌥', '🌦', '🌧', '⛈', '⚡️', '🔥', '❄️', '🌨', '☔️', '☂️', '🌪', '💨', '☃️', '⛄️', '💧', '💦', '🌊', '🍏', '🍎', '🍐', '🍋', '🍌', '🍉', '🍇', '🌶', '🍅', '🍍', '🍑', '🍈', '🍓', '🌽', '🍠', '🍯', '🍞', '🍗', '🧀', '🍖', '🍤', '🌯', '🌮', '🍝', '🍕', '🌭', '🍟', '🍔', '🍳', '🍜', '🍲', '🍥', '🍣', '🍱', '🍛', '🍙', '🍚', '🎂', '🍰', '🍦', '🍨', '🍧', '🍡', '🍢', '🍘', '🍮', '🍬', '🍭', '🍫', '🍿', '🍩', '🍪', '🍺', '☕️', '🍵', '🍶', '🍹', '🍻', '🍼', '🍴', '🍷', '🍽', '⚽️', '🏀', '🏈', '⚾️', '🎾', '🏐', '🏉', '🎱', '🎿', '🏏', '🏑', '🏓', '🏌', '⛳️', '⛷', '🏂', '⛸', '🏹', '🎣', '🚣', '🏊🏼', '🏄', '🏆', '🕴', '🏇', '🚵', '🚴', '🏋', '⛹', '🛀', '🎽', '🏅', '🎖', '🎗', '🏵', '🎫', '🎟', '🎭', '🎺', '🎷', '🎹', '🎤', '🎪', '🎨', '🎸', '🎻', '🎬', '🎮', '👾', '🎯', '🎲', '🎰', '🎳', '🚗', '🚕', '🚙', '🚌', '🚎', '🏎', '🚓', '🚒', '🚐', '🚛', '🚜', '🏍', '🚲', '🚨', '🚃', '🚟', '🚠', '🚡', '🚖', '🚘', '🚍', '🚔', '🚋', '🚝', '🚄', '🚅', '🚈', '🚞', '🚂', '🚆', '🛬', '🛫', '✈️', '🛩', '🚁', '🚉', '🚊', '🚇', '⛵️', '🛥', '🚤', '⛴', '🚀', '🛳', '🛰', '💺', '🏁', '🚥', '🚦', '🚏', '⛽️', '🚧', '⚓️', '🎡', '🎢', '🎠', '🏗', '🌁', '🗼', '🏭', '⛲️', '⛺️', '🏕', '🗾', '🌋', '🗻', '🏔', '⛰', '🎑', '🏞', '🛣', '🛤', '🌅', '🌄', '🏜', '🏖', '🏝', '🎇', '🌠', '🌌', '🌉', '🌃', '🏙', '🌆', '🌇', '🎆', '🌈', '🏘', '🏰', '🏯', '🏠', '🗽', '🏟', '🏡', '🏚', '🏢', '🏬', '🏣', '🏤', '🏥', '🏦', '🕌', '⛪️', '🏛', '💒', '🏩', '🏫', '🏪', '🏨', '🕍', '🕋', '⛩', '🕹', '💽', '💾', '💿', '📼', '📷', '📹', '🎥', '☎️', '⏱', '🎙', '📻', '📺', '📠', '📟', '⏲', '⏰', '🕰', '⏳', '📡', '🔋', '💴', '💵', '💸', '🛢', '🔦', '💡', '💶', '💷', '💰', '💳', '💎', '🔨', '💣', '🔫', '🔪', '☠️', '🔮', '💈', '💊', '💉', '🔖', '🚿', '🔑', '🛋', '🚪', '🛎', '🖼', '🎁', '🎀', '🎏', '🎈', '🛍', '⛱', '🗺', '🎊', '🎉', '🎎', '🎐', '🎌', '🏮', '📮', '📫', '📯', '📊', '🗃', '📇', '📅', '📉', '📈', '📰', '📕', '📙', '📒', '✂️', '🖇', '📖', '📚', '📌', '📍', '🚩', '❤️', '💔', '❣️', '💕', '💓', '💗', '💖', '💘', '💝', '💠', '🔔']
const rnd = a => a[ (Math.random() * a.length) | 0 ]

const _Demo = (props, { setGlobal, ...globals }) => (
  <div>
    <meta charset='utf-8' />
    <h1>{globals.whatever}</h1>
    <button onClick={e => setGlobal('whatever', `${rnd(emojis)} COOL! ${rnd(emojis)}`)}>COOL IT</button>
  </div>
)

// wrap all your components that use global-state:
const Demo = withGlobal(_Demo)

// setup the global provider in your app, somewhere at the top
const App = () => (
  <GlobalProvider whatever='initial whatever value'>
    <div>
      <Demo />
    </div>
  </GlobalProvider>
)

if (typeof window !== 'undefined') {
  render(<App />, document.body, document.body.firstChild)
}
